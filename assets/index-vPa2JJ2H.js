import{r as e,j as t}from"./react-three-BdgxNMf0.js";import{G as n,D as i,a as o,P as a,R as r,E as s,A as c,L as d,b as l,S as m,W as u,c as h,d as y,C as p,M as f}from"./three-CbFrQusb.js";import{g}from"./gsap-BaqsKTKs.js";import{u as w,s as v}from"./index-DeufdUuj.js";import{S as L}from"./ScrollTrigger-Cyj2mlPb.js";import"./vendor-DgkQOziQ.js";function x(e,t){let n=0;setInterval(()=>{n=Math.random()},200);const i=g.timeline({scrollTrigger:{trigger:".landing-section",start:"top top",end:"bottom top",scrub:!0,invalidateOnRefresh:!0}}),o=g.timeline({scrollTrigger:{trigger:".about-section",start:"center 55%",end:"bottom top",scrub:!0,invalidateOnRefresh:!0}}),a=g.timeline({scrollTrigger:{trigger:".whatIDO",start:"top top",end:"bottom top",scrub:!0,invalidateOnRefresh:!0}});let r,s;null==e||e.children.forEach(e=>{"Plane004"===e.name&&e.children.forEach(e=>{e.material.transparent=!0,e.material.opacity=0,"Material.027"===e.material.name&&(s=e,e.material.color.set("#FFFFFF"))}),"screenlight"===e.name&&(e.material.transparent=!0,e.material.opacity=0,e.material.emissive.set("#C8BFFF"),g.timeline({repeat:-1,repeatRefresh:!0}).to(e.material,{emissiveIntensity:()=>8*n,duration:()=>.6*Math.random(),delay:()=>.1*Math.random()}),r=e)});let c=null==e?void 0:e.getObjectByName("spine005");if(window.innerWidth>1024)e&&(i.fromTo(e.rotation,{y:0},{y:.7,duration:1},0).to(t.position,{z:22},0).fromTo(".character-model",{x:0},{x:"-25%",duration:1},0).to(".landing-container",{opacity:0,duration:.4},0).to(".landing-container",{y:"40%",duration:.8},0).fromTo(".about-me",{y:"-50%"},{y:"0%"},0),o.to(t.position,{z:75,y:8.4,duration:6,delay:2,ease:"power3.inOut"},0).to(".about-section",{y:"30%",duration:6},0).to(".about-section",{opacity:0,delay:3,duration:2},0).fromTo(".character-model",{pointerEvents:"inherit"},{pointerEvents:"none",x:"-12%",delay:2,duration:5},0).to(e.rotation,{y:.92,x:.12,delay:3,duration:3},0).to(c.rotation,{x:.6,delay:2,duration:3},0).to(s.material,{opacity:1,duration:.8,delay:3.2},0).to(r.material,{opacity:1,duration:.8,delay:4.5},0).fromTo(".what-box-in",{display:"none"},{display:"flex",duration:.1,delay:6},0).fromTo(s.position,{y:-10,z:2},{y:0,z:0,delay:1.5,duration:3},0).fromTo(".character-rim",{opacity:1,scaleX:1.4},{opacity:0,scale:0,y:"-70%",duration:5,delay:2},.3),a.fromTo(".character-model",{y:"0%"},{y:"-100%",duration:4,ease:"none",delay:1},0).fromTo(".whatIDO",{y:0},{y:"15%",duration:2},0).to(e.rotation,{x:-.04,duration:2,delay:1},0));else if(e){g.timeline({scrollTrigger:{trigger:".what-box-in",start:"top 70%",end:"bottom top"}}).to(".what-box-in",{display:"flex",duration:.1,delay:0},0)}}function R(){const e=g.timeline({scrollTrigger:{trigger:".career-section",start:"top 50%",end:"bottom 30%",scrub:1.5,invalidateOnRefresh:!0}});e.fromTo(".career-timeline",{maxHeight:"0%"},{maxHeight:"100%",duration:1,ease:"none"},0).fromTo(".career-timeline",{opacity:0},{opacity:1,duration:.2},0).fromTo(".career-info-box",{opacity:0},{opacity:1,stagger:.1,duration:.5},0).fromTo(".career-dot",{animationIterationCount:"infinite"},{animationIterationCount:"1",delay:.3,duration:.1},0),window.innerWidth>1024?e.fromTo(".career-section",{y:0},{y:"20%",duration:.5,delay:.2},0):e.fromTo(".career-section",{y:0},{y:0,duration:.5,delay:.2},0)}const b=async(e,t)=>{const n=await fetch(e),i=await n.arrayBuffer(),o=new Uint8Array(i.slice(0,16)),a=i.slice(16),r=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return crypto.subtle.importKey("raw",n.slice(0,32),{name:"AES-CBC"},!1,["encrypt","decrypt"])}(t);return crypto.subtle.decrypt({name:"AES-CBC",iv:o},r,a)};function _(e,t,n,i){if(!n.current)return;let o=n.current.getBoundingClientRect();const a=o.width,r=o.height;e.setSize(a,r),t.aspect=a/r,t.updateProjectionMatrix();const s=L.getById("work");L.getAll().forEach(e=>{e!=s&&e.kill()}),x(i,t),R()}const E=["thighL","thighR","shinL","shinR","forearmL","forearmR","handL","handR","f_pinky03R","f_pinky02L","f_pinky02R","f_pinky01L","f_pinky01R","palm04L","palm04R","f_ring01L","thumb01L","thumb01R","thumb03L","thumb03R","palm02L","palm02R","palm01L","palm01R","f_index01L","f_index01R","palm03L","palm03R","f_ring02L","f_ring02R","f_ring01R","f_ring03L","f_ring03R","f_middle01L","f_middle02L","f_middle03L","f_middle01R","f_middle02R","f_middle03R","f_index02L","f_index03L","f_index02R","f_index03R","thumb02L","f_pinky03L","upper_armL","upper_armR","thumb02R","toeL","heel02L","toeR","heel02R"],T=["eyebrow_L","eyebrow_R"],j=(e,t,n,i)=>{const o=l.findByName(e.animations,n);if(!o)return null;const a=A(o,i);return t.clipAction(a)},A=(e,t)=>{const n=e.tracks.filter(e=>t.some(t=>e.name.includes(t)));return new l(e.name+"_filtered",e.duration,n)},O=()=>{const L=e.useRef(null),A=e.useRef(null),O=e.useRef(new m),{setLoading:B}=w(),[C,S]=e.useState(null);return e.useEffect(()=>{if(L.current){let e=L.current.getBoundingClientRect(),t={width:e.width,height:e.height};const m=t.width/t.height,w=O.current,I=new u({alpha:!0,antialias:window.devicePixelRatio<2,powerPreference:"high-performance"});I.setSize(t.width,t.height),I.setPixelRatio(Math.min(window.devicePixelRatio,2)),I.toneMapping=h,I.toneMappingExposure=1,L.current.appendChild(I.domElement);const k=new y(14.5,m,.1,1e3);k.position.z=10,k.position.set(0,13.1,24.7),k.zoom=1.1,k.updateProjectionMatrix();let F,P=null,z=null;const M=new p,N=(e=>{const t=new o(13085183,0);t.intensity=0,t.position.set(-.47,-.32,-1),t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024,t.shadow.camera.near=.5,t.shadow.camera.far=50,e.add(t);const n=new a(12756223,0,100,3);n.position.set(3,12,4),n.castShadow=!0,e.add(n),(new r).setPath("/models/").load("char_enviorment.hdr",function(t){t.mapping=s,e.environment=t,e.environmentIntensity=0,e.environmentRotation.set(5.76,85.85,1)});const i="power2.inOut";return{setPointLight:function(e){e.material.opacity>.9?n.intensity=20*e.material.emissiveIntensity:n.intensity=0},turnOnLights:function(){g.to(e,{environmentIntensity:.64,duration:2,ease:i}),g.to(t,{intensity:1,duration:2,ease:i}),g.to(".character-rim",{y:"55%",opacity:1,delay:.2,duration:2})}}})(w);let W=v(e=>B(e));const{loadCharacter:D}=((e,t,o)=>{const a=new n,r=new i;return r.setDecoderPath("/draco/"),a.setDRACOLoader(r),{loadCharacter:()=>new Promise(async(n,i)=>{try{const s=await b("/models/character.enc","Character3D#@"),c=URL.createObjectURL(new Blob([s]));let d;a.load(c,async i=>{d=i.scene,await e.compileAsync(d,o,t),d.traverse(e=>{if(e.isMesh){const t=e;e.castShadow=!1,e.receiveShadow=!1,t.frustumCulled=!0,t.material&&!Array.isArray(t.material)&&(t.material.precision="mediump")}}),n(i),x(d,o),R(),d.getObjectByName("footR").position.y=3.36,d.getObjectByName("footL").position.y=3.36,r.dispose()},void 0,e=>{i(e)})}catch(s){i(s)}})}})(I,w,k);D().then(e=>{if(e){const t=(e=>{let t=e.scene,n=new c(t);if(e.animations){const t=e.animations.find(e=>"introAnimation"===e.name),i=n.clipAction(t);i.setLoop(d,1),i.clampWhenFinished=!0,i.play(),["key1","key2","key5","key6"].forEach(t=>{const i=l.findByName(e.animations,t);if(i){const e=null==n?void 0:n.clipAction(i);e.play(),e.timeScale=1.2}});let o=null;o=j(e,n,"typing",E),o&&(o.enabled=!0,o.play(),o.timeScale=1.2)}return{mixer:n,startIntro:function(){const t=e.animations.find(e=>"introAnimation"===e.name),i=n.clipAction(t);i.clampWhenFinished=!0,i.reset().play(),setTimeout(()=>{const t=e.animations.find(e=>"Blink"===e.name);n.clipAction(t).play().fadeIn(.5)},2500)},hover:function(e,t){let i=j(e,n,"browup",T),o=!1;i&&(i.setLoop(d,1),i.clampWhenFinished=!0,i.enabled=!0);const a=()=>{i&&!o&&(o=!0,i.reset(),i.enabled=!0,i.setEffectiveWeight(4),i.fadeIn(.5).play())},r=()=>{i&&o&&(o=!1,i.fadeOut(.6))};if(t)return t.addEventListener("mouseenter",a),t.addEventListener("mouseleave",r),()=>{t.removeEventListener("mouseenter",a),t.removeEventListener("mouseleave",r)}}}})(e);A.current&&t.hover(e,A.current),F=t.mixer;let n=e.scene;S(n),w.add(n),P=n.getObjectByName("spine006")||null,z=n.getObjectByName("screenlight")||null,W.loaded().then(()=>{setTimeout(()=>{N.turnOnLights(),t.startIntro()},2500)}),window.addEventListener("resize",()=>_(I,k,L,n))}});let H={x:0,y:0},U={x:.1,y:.2};const X=e=>{((e,t)=>{t(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)})(e,(e,t)=>H={x:e,y:t})};let Y;const q=e=>{const t=e.target;Y=setTimeout(()=>{null==t||t.addEventListener("touchmove",e=>((e,t)=>{t(e.touches[0].clientX/window.innerWidth*2-1,-e.touches[0].clientY/window.innerHeight*2+1)})(e,(e,t)=>H={x:e,y:t}))},200)},G=()=>{var e;e=(e,t,n,i)=>{H={x:e,y:t},U={x:n,y:i}},setTimeout(()=>{e(0,0,.03,.03),setTimeout(()=>{e(0,0,.1,.2)},1e3)},2e3)};document.addEventListener("mousemove",e=>{X(e)});const K=document.getElementById("landingDiv");K&&(K.addEventListener("touchstart",q),K.addEventListener("touchend",G));const J=()=>{requestAnimationFrame(J),P&&(((e,t,n,i,o,a)=>{if(e)if(window.scrollY<200){const r=Math.PI/6;e.rotation.y=a(e.rotation.y,t*r,o);let s=-.3,c=.4;e.rotation.x=a(e.rotation.x,n>s?n<c?-n-.5*r:-r-.5*r:-s-.5*r,i)}else window.innerWidth>1024&&(e.rotation.x=a(e.rotation.x,-.4,.03),e.rotation.y=a(e.rotation.y,-.3,.03))})(P,H.x,H.y,U.x,U.y,f.lerp),N.setPointLight(z));const e=M.getDelta();F&&F.update(e),I.render(w,k)};return J(),()=>{clearTimeout(Y),w.clear(),I.dispose(),window.removeEventListener("resize",()=>_(I,k,L,C)),L.current&&L.current.removeChild(I.domElement),K&&(document.removeEventListener("mousemove",X),K.removeEventListener("touchstart",q),K.removeEventListener("touchend",G))}}},[]),t.jsx(t.Fragment,{children:t.jsx("div",{className:"character-container",children:t.jsxs("div",{className:"character-model",ref:L,children:[t.jsx("div",{className:"character-rim"}),t.jsx("div",{className:"character-hover",ref:A})]})})})},B=()=>t.jsx(O,{});export{B as default};
